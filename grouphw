-Group Project

--Drop tables plus cascade constraints
DROP TABLE email CASCADE CONSTRAINTS;
DROP TABLE dobirth CASCADE CONSTRAINTS;
DROP TABLE familyinfo CASCADE CONSTRAINTS;
DROP TABLE mbr CASCADE CONSTRAINTS;
DROP TABLE phone CASCADE CONSTRAINTS;    
DROP TABLE personphone CASCADE CONSTRAINTS; 
DROP TABLE address CASCADE CONSTRAINTS;
DROP TABLE personaddress CASCADE CONSTRAINTS; 
DROP TABLE person_org CASCADE CONSTRAINTS;
DROP TABLE org CASCADE CONSTRAINTS;
DROP TABLE person CASCADE CONSTRAINTS;

--Drop statments for Sequences


--The code below creates a table for Person where personid is the primary key
--Constraint for gender; M= Male, F= Female, O= Other
CREATE TABLE person(
  personid NUMBER(6) NOT NULL,
  lname    VARCHAR2(35) NOT NULL,
  fname    VARCHAR2(35) NOT NULL,
  mname    VARCHAR2 (35),
  gender   CHAR(1),
  CONSTRAINT persongender_cc CHECK (gender IN ('M','F','O')),
  CONSTRAINT personid_pk PRIMARY KEY (personid));
  
--The code below creates a table for Email where emailid is the primary key
CREATE TABLE email (
  personid NUMBER(6) NOT NULL,
  email_add VARCHAR2(35) NOT NULL,
  CONSTRAINT email_pk PRIMARY KEY (personid),
  CONSTRAINT email_fk FOREIGN KEY (personid) REFERENCES person (personid));

  
--The code below creates table for Authorized Individual where authorizedindid and memberid are the primary and foreign keys
--Check constraints are for emergency contact, authorized to pick up, head of the house hold and edit account information
--These constraints are all yes or no questions,so 'Y'= yes and n= 'N'
--Check constraint for relationship: 'P' = Parent, 'GP' = Grandparent, 'G' = Guardian, 'OR' = Other Relationship
CREATE TABLE authorized_individual (
  authorizedindid NUMBER(6) NOT NULL,
  memberid        NUMBER(6) NOT NULL,
  relationship    VARCHAR2(2) NOT NULL,
  orelationship   VARCHAR2(25),
  emg_cont        CHAR(1) NOT NULL,
  auth_pickup     CHAR(1) NOT NULL,
  headofhouse     CHAR(1) NOT NULL,
  edit_acct_info  CHAR(1) NOT NULL,
  CONSTRAINT authorized_relation_cc CHECK (relationship IN ('P', 'GP', 'G', 'OR')),
  CONSTRAINT authorized_emg_cont_cc CHECK (emg_cont IN ('Y', 'N')),
  CONSTRAINT authorized_individual_cc CHECK (auth_pickup IN ('Y', 'N')),
  CONSTRAINT authorized_headofhouse_cc CHECK (headofhouse IN ('Y', 'N')),
  CONSTRAINT authorized_edit_acct_info_cc CHECK (edit_acct_info IN ('Y', 'N')),
  CONSTRAINT authorizedmemberid_pk PRIMARY KEY (authorizedindid, memberid),
  CONSTRAINT authorizedindid_fk FOREIGN KEY (authorizedindid) REFERENCES person (personid),
  CONSTRAINT authorizedmemberid_fk FOREIGN KEY (memberid) REFERENCES person (personid));

--The code below creates table for Date of Birth where birthid is the primary key
CREATE TABLE dobirth (
  birthid   NUMBER (6) NOT NULL,
  dob       DATE NOT NULL,
  CONSTRAINT dobirth_pk PRIMARY KEY (birthid));

--The code below creates table for Family Information where famid is the primary key
CREATE TABLE familyinfo (
  famid     NUMBER (6) NOT NULL,
  famsize   NUMBER (20) NOT NULL,
  famincome NUMBER (10) NOT NULL,
  military  CHAR (1) NOT NULL,
  branch    VARCHAR2(25) NOT NULL,
  liveswith VARCHAR2 (2) NOT NULL,
  CONSTRAINT familyinfo_lives_cc CHECK (liveswith IN ('B', 'M', 'F', 'GP', 'G', 'R', 'FP')),
  CONSTRAINT familyinfo_pk PRIMARY KEY (famid));


--The code below creates table for Member where memberid is the primary key
--Constraint for ethnicity where 'C'= Caucasian, 'AA' = African American, 'AI' = American Indian, 'AP' = Asian-Asian Pacific,
--'HP' = Hispanic-Latino, 'ME' = Multi-Ethnic, 'O'= Other
CREATE TABLE mbr (
  memberid    NUMBER (6) NOT NULL,
  ethnicty    VARCHAR2 (2),
  eth_other   VARCHAR2 (35),
  birthid     NUMBER(6) NOT NULL,
  famid       NUMBER(6) NOT NULL,
  CONSTRAINT mbr_ethnicty_cc CHECK (ethnicty IN ('C', 'AA','AI','AP','HP','ME','O')),
  CONSTRAINT mbr_memberid_pk PRIMARY KEY (memberid),
  CONSTRAINT mbr_memberid_fk FOREIGN KEY (memberid) REFERENCES person (PERSONID),
  CONSTRAINT mbr_birthid_fk FOREIGN KEY (birthid) REFERENCES dobirth (birthid),
  CONSTRAINT mbr_famid_fk FOREIGN KEY (famid) REFERENCES familyinfo (famid));

--The code below creates the Phone table where phoneid is the primary key. Where Phone Types: 'M'= Mobile, 'H'= Home, 'W' = Work
CREATE TABLE phone (
  phoneid NUMBER (6),
  pnumber NUMBER (10) NOT NULL,
  ptype  CHAR (1) NOT NULL,
  CONSTRAINT phone_ptype_cc CHECK ((ptype='M') OR (ptype='H') OR (ptype = 'W')),
  CONSTRAINT phone_phoneid_pk PRIMARY KEY (phoneid));

--The code below creates the Personphone table which is the associative table that connects phone and person where phonid and personid are the primary and foreign keys
CREATE TABLE personphone (
  personid NUMBER (6) NOT NULL,
  phoneid NUMBER (6) NOT NULL, 
  CONSTRAINT personphone_personid_fk FOREIGN KEY (personid) REFERENCES person (personid),
  CONSTRAINT personphone_phoneid_fk FOREIGN KEY (phoneid) REFERENCES phone (phoneid));

--The code below creates the Address table where addrid is the primary key
CREATE TABLE address (
  addrid NUMBER (6) NOT NULL,
  strt VARCHAR2 (35) NOT NULL,
  city VARCHAR2 (35) NOT NULL,
  ste CHAR (2) DEFAULT 'WI' NOT NULL,
  zipcode VARCHAR2 (10) NOT NULL,
  CONSTRAINT addr_addrid_pk PRIMARY KEY(addrid));

--The code below creates the Personaddress table which is the associative table that connects address and person 
--Where addrid and personid are the primary and foreign keys
CREATE TABLE personaddress (
  addrid NUMBER (5) NOT NULL, 
  personid NUMBER (5) NOT NULL,
  CONSTRAINT personaddr_peraddr_pk PRIMARY KEY (addrid,personid),
  CONSTRAINT personaddr_personid_fk FOREIGN KEY (personid) REFERENCES person (personid),
  CONSTRAINT personaddr_addrid_fk FOREIGN KEY (addrid) REFERENCES address (addrid));
  
-- The code below creates the table for Organization where org_id is the primary key
CREATE TABLE org (
  org_id  NUMBER(6) NOT NULL,
  org_name VARCHAR2(35) NOT NULL,
  CONSTRAINT org_org_id_pk PRIMARY KEY (org_id));



--The code below creates the table for Person_Org where org_id and personid are the primary and foreign keys
CREATE TABLE person_org (
  personid NUMBER(6) NOT NULL,
  org_id  NUMBER(6) NOT NULL,
  CONSTRAINT person_org_pk PRIMARY KEY (personid, org_id),
  CONSTRAINT person_org_person_fk FOREIGN KEY (personid) REFERENCES person (personid),
  CONSTRAINT person_org_org_fk FOREIGN KEY (org_id) REFERENCES org (org_id));
